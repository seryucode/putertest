// AI生成処理（デバッグ版）
    async function generateText() {
      const prompt = document.getElementById('prompt').value;
      const out = document.getElementById('output');
      
      if(!prompt) return alert("お題を入力しろ。");
      
      out.innerText = "Claudeが思考中...";
      
      try {
        // モデル指定なしで試す（一番通りやすい設定）
        // ストリーミングも一旦OFFにして、原因を切り分ける
        const resp = await puter.ai.chat(prompt);

        // 成功した場合
        const text = resp?.message?.content?.[0]?.text || resp?.text || JSON.stringify(resp);
        out.innerText = text;

      } catch (e) {
        // エラーの全貌を暴く
        console.error(e);
        let errorMsg = "【エラー詳細】\n";
        
        // JSON形式で展開して表示
        try {
            errorMsg += JSON.stringify(e, null, 2);
        } catch (jsonErr) {
            errorMsg += String(e);
        }

        // もし中身が空なら、隠れているメッセージを探す
        if (e.message) errorMsg += "\n\nMessage: " + e.message;
        if (e.code) errorMsg += "\nCode: " + e.code;
        
        out.innerText = errorMsg;
      }
    }
